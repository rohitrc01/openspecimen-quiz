<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OpenSpecimen Quiz</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(135deg, #f0faff, #ffffff);
    color: #333;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
  }

  h1 {
    color: #0077b6;
    margin-bottom: 10px;
    text-align: center;
  }

  p {
    text-align: center;
    color: #555;
    margin-bottom: 25px;
  }

  .quiz-container {
    background: #ffffff;
    padding: 30px 40px;
    border-radius: 16px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 650px;
    text-align: center;
    position: relative;
  }

  .progress-container {
    width: 100%;
    background: #e0f7fa;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
    height: 14px;
  }

  .progress-bar {
    height: 14px;
    width: 0;
    background-color: #00b4d8;
    transition: width 0.4s ease;
  }

  .progress-text {
    text-align: right;
    font-size: 14px;
    color: #0077b6;
    margin-bottom: 5px;
  }

  .question {
    display: none;
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin: 8px 0;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
    text-align: left;
  }

  label:hover {
    background-color: #e1f5fe;
  }

  input[type="radio"], input[type="checkbox"] {
    margin-right: 8px;
  }

  button {
    background: #0077b6;
    color: #fff;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 15px;
    transition: 0.3s;
  }

  button:hover {
    background: #0096c7;
  }

  input[type="text"] {
    padding: 8px;
    width: 250px;
    border-radius: 6px;
    border: 1px solid #ccc;
    text-align: center;
  }

  .result {
    margin-top: 25px;
    padding: 15px;
    background: #f1f9ff;
    border-radius: 12px;
    border: 1px solid #b3e5fc;
    color: #006064;
  }

  .correct {
    background-color: #d4edda;
    color: #155724;
  }

  .wrong {
    background-color: #f8d7da;
    color: #721c24;
  }

  .hidden { display: none; }

  footer {
    margin-top: 25px;
    font-size: 14px;
    color: #777;
    text-align: center;
  }

  footer a {
    color: #0077b6;
    text-decoration: none;
  }
</style>
</head>
<body>

<h1>üß™ OpenSpecimen Quiz</h1>


<div class="quiz-container">
  <div id="name-section">
    <label><strong>Your Name:</strong></label>
    <input type="text" id="name" placeholder="Enter your name">
    <br><br>
    <button id="startBtn">Start Quiz ‚ñ∂</button>
  </div>

  <div id="progressWrapper" class="hidden">
    <div class="progress-text" id="progressText"></div>
    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>
  </div>

  <form id="quizForm" class="hidden">
    <!-- Q1 -->
    <div class="question">
      <strong>1. Which default role provides a user with the ability to perform all operations within their assigned site(s)?</strong>
      <label><input type="radio" name="q1" value="A"> A) Site Administrator</label>
      <label><input type="radio" name="q1" value="B"> B) Coordinator</label>
      <label><input type="radio" name="q1" value="C"> C) Tissue Banker</label>
      <label><input type="radio" name="q1" value="D"> D) Researcher</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <!-- Q2 (MSQ) -->
    <!-- the question is changed, include the option all of the above  -->
    <div class="question">
      <strong>2. Which two (or more) privileges are typically reserved for Super Administrators in OpenSpecimen?  (MSQ)</strong>
      <label><input type="checkbox" name="q2" value="A"> A) Creating Institutes and Sites</label>
      <label><input type="checkbox" name="q2" value="B"> B) Configuring system settings</label>
      <label><input type="checkbox" name="q2" value="C"> C) Creating another Super Administrator</label>
      <label><input type="checkbox" name="q2" value="D"> D) Managing data across a Institute and Site</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <!-- (Questions 3‚Äì10 remain identical as before) -->
    <div class="question"><strong>3. A Researcher reports that they cannot see patient names or dates of birth. What is the most likely reason?</strong>
      <label><input type="radio" name="q3" value="A"> A) Their account is locked</label>
      <label><input type="radio" name="q3" value="B"> B) PHI access is disabled for their role</label>
      <label><input type="radio" name="q3" value="C"> C) They haven‚Äôt joined a site</label>
      <label><input type="radio" name="q3" value="D"> D) The data is corrupted</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>4. Which of the following can be registered as a Contact User for an Institute or Site?</strong>
      <label><input type="radio" name="q4" value="A"> A) Researcher</label>
      <label><input type="radio" name="q4" value="B"> B) Technician</label>
      <label><input type="radio" name="q4" value="C"> C) Nurse</label>
      <label><input type="radio" name="q4" value="D"> D) Tissue Banker</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>5. In the hierarchy Institute ‚Üí Site ‚Üí Collection Protocol, if a user belongs to Site ‚ÄúX‚Äù under Institute ‚ÄúY‚Äù, their data visibility is determined by:</strong>
      <label><input type="radio" name="q5" value="A"> A) Institute only</label>
      <label><input type="radio" name="q5" value="B"> B) Site only</label>
      <label><input type="radio" name="q5" value="C"> C) Institute + Site</label>
      <label><input type="radio" name="q5" value="D"> D) Collection Protocol only</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>6. Why would an admin create a custom role?</strong>
      <label><input type="radio" name="q6" value="A"> A) To combine permissions from multiple roles</label>
      <label><input type="radio" name="q6" value="B"> B) To bypass PHI restrictions</label>
      <label><input type="radio" name="q6" value="C"> C) To add users without approval</label>
      <label><input type="radio" name="q6" value="D"> D) To reset passwords faster</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>7. Arrange the following in the correct hierarchy order (Top ‚Üí Bottom): Site, Institute, Collection Protocol, Participant</strong>
      <label><input type="radio" name="q7" value="A"> A) Site ‚Üí Institute ‚Üí Collection Protocol ‚Üí Participant</label>
      <label><input type="radio" name="q7" value="B"> B) Institute ‚Üí Site ‚Üí Collection Protocol ‚Üí Participant</label>
      <label><input type="radio" name="q7" value="C"> C) Institute ‚Üí Collection Protocol ‚Üí Site ‚Üí Participant</label>
      <label><input type="radio" name="q7" value="D"> D) Collection Protocol ‚Üí Institute ‚Üí Site ‚Üí Participant</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>8. Which of these can impersonate other users to check visibility and permissions?</strong>
      <label><input type="radio" name="q8" value="A"> A) Institute Admin</label>
      <label><input type="radio" name="q8" value="B"> B) Super Admin</label>
      <label><input type="radio" name="q8" value="C"> C) Site Admin</label>
      <label><input type="radio" name="q8" value="D"> D) Technician</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>9. A Technician accidentally entered the wrong password five times and got locked out. What should the admin do?</strong>
      <label><input type="radio" name="q9" value="A"> A) Delete the user</label>
      <label><input type="radio" name="q9" value="B"> B) Wait for the system to auto-unlock</label>
      <label><input type="radio" name="q9" value="C"> C) Unlock the user manually from User Settings</label>
      <label><input type="radio" name="q9" value="D"> D) Reset the server</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>

    <div class="question"><strong>10. Can a user belong to more than one institute in OpenSpecimen?</strong>
      <label><input type="radio" name="q10" value="A"> A) Yes</label>
      <label><input type="radio" name="q10" value="B"> B) No</label>
      <label><input type="radio" name="q10" value="C"> C) Only if they are Super Admin</label>
      <label><input type="radio" name="q10" value="D"> D) Only if they are a Contact User</label>
      <button type="button" class="submitAnswer">Submit Answer</button>
    </div>
  </form>

  <div id="result" class="result hidden"></div>
</div>

<footer>
  <p>Created by <strong>Rohit Chaudhari</strong> | OpenSpecimen Training Quiz</p>
</footer>

<script>
const correctAnswers = {
  q1: ["A"], q2: ["A","B","C",], q3: ["B"], q4: ["C"], q5: ["C"],
  q6: ["A"], q7: ["B"], q8: ["B"], q9: ["C"], q10: ["B"]
};

let score = 0;
let current = 0;
const total = Object.keys(correctAnswers).length;
const questions = document.querySelectorAll(".question");
const resultDiv = document.getElementById("result");
const progressBar = document.getElementById("progressBar");
const progressText = document.getElementById("progressText");

document.getElementById("startBtn").onclick = () => {
  const name = document.getElementById("name").value.trim();
  if (!name) return alert("Please enter your name to start.");
  document.getElementById("name-section").classList.add("hidden");
  document.getElementById("quizForm").classList.remove("hidden");
  document.getElementById("progressWrapper").classList.remove("hidden");
  showQuestion(current);
  updateProgress();
};

function showQuestion(i) {
  questions.forEach((q, index) => q.style.display = index === i ? "block" : "none");
  updateProgress();
}

function updateProgress() {
  const percent = ((current) / total) * 100;
  progressBar.style.width = `${percent}%`;
  progressText.innerText = `Question ${current + 1} of ${total}`;
}

document.querySelectorAll(".submitAnswer").forEach((btn, idx) => {
  btn.onclick = () => {
    const qKey = Object.keys(correctAnswers)[idx];
    const correct = correctAnswers[qKey];
    const selected = Array.from(document.querySelectorAll(`[name=${qKey}]:checked`)).map(i => i.value);
    if (selected.length === 0) return alert("Please select an answer before submitting.");

    const qDiv = questions[idx];
    qDiv.querySelectorAll("label").forEach(label => {
      const input = label.querySelector("input");
      input.disabled = true;
      if (correct.includes(input.value)) label.classList.add("correct");
      else if (input.checked && !correct.includes(input.value)) label.classList.add("wrong");
    });

    if (JSON.stringify(selected.sort()) === JSON.stringify(correct.sort())) score++;

    setTimeout(() => {
      qDiv.style.display = "none";
      current++;
      if (current < questions.length) showQuestion(current);
      else finishQuiz();
    }, 1500);
  };
});

function finishQuiz() {
  progressBar.style.width = "100%";
  progressText.innerText = "Quiz Completed üéâ";
  const name = document.getElementById("name").value.trim() || "Anonymous";
  const percent = ((score / total) * 100).toFixed(2);
  resultDiv.innerHTML = `
    <h2>üéâ Great work, ${name}!</h2>
    <p>You scored <strong>${score}/${total}</strong> (${percent}%)</p>
    <button onclick="location.reload()">Restart Quiz</button>
  `;
  resultDiv.classList.remove("hidden");

  const payload = { name, score: percent, correct: score, total };
  try {
    fetch("https://script.google.com/macros/s/AKfycbwjWphgRxDVrDc5AuWh5GDOyJFuJ013rMtLcfr9AAqbTPkAMkGs00pBr-19cvVdk9PJ/exec", {
      method: "POST", mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
  } catch (e) { console.error("Error:", e); }
}
</script>

</body>
</html>
